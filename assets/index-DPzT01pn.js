const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FrontLayout-DSSIPlJS.js","assets/vue-vendor-CO2Qqhmb.js","assets/vue-vendor-BAFL1yxD.css","assets/vendor-oObasS19.js","assets/mdi-vendor-aPHlSQtF.css","assets/HomeView-BcfP3cDl.js","assets/HomeView-zYBd93x1.css","assets/RegisterView-1aTmBjFY.js","assets/LoginView-rIPiDv6-.js","assets/BookView-OhGwN6TI.js","assets/MybookView-CCmkmaP2.js","assets/CartView-DsV7s1gd.js","assets/OrdersView-Cu_4P00B.js","assets/AdminLayout-2n7cqc3g.js","assets/HomeView-D2VODeFg.js","assets/BookmanagementView-BXqBRqRm.js","assets/BookmanagementView-Dd_KhQgX.css","assets/OrdersView-PcA0w40T.js","assets/ImportView-IXBhG5GJ.js"])))=>i.map(i=>d[i]);
var g=(e,r,o)=>new Promise((a,t)=>{var s=m=>{try{i(o.next(m))}catch(c){t(c)}},n=m=>{try{i(o.throw(m))}catch(c){t(c)}},i=m=>m.done?a(m.value):Promise.resolve(m.value).then(s,n);i((o=o.apply(e,r)).next())});import{y as I,z as T,r as _,d as L,A as D,B as V,S,C as w,D as B,E as C,F as U,G as H,H as N,V as z,I as j}from"./vue-vendor-CO2Qqhmb.js";/* empty css                   */import{c as q,s as x,a as E,d as F}from"./vendor-oObasS19.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();const W="modulepreload",$=function(e){return"/book-front/"+e},O={},l=function(r,o,a){let t=Promise.resolve();if(o&&o.length>0){let m=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),i=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));t=m(o.map(c=>{if(c=$(c),c in O)return;O[c]=!0;const d=c.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":W,d||(p.as="script"),p.crossOrigin="",p.href=c,i&&p.setAttribute("nonce",i),document.head.appendChild(p),d)return new Promise((u,k)=>{p.addEventListener("load",u),p.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(n){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n}return t.then(n=>{for(const i of n||[])i.status==="rejected"&&s(i.reason);return r().catch(s)})},R=I({theme:{themes:{light:{colors:{primary:"#1867C0",secondary:"#5CBBF6"}}}},locale:{locale:"zhHant",messages:{zhHant:T}},icons:{defaultSet:"mdi"}}),b=q();b.use(x);const v={USER:0,ADMIN:1},M=E.create({baseURL:"https://book-back-b23l.onrender.com"}),h=E.create({baseURL:"https://book-back-b23l.onrender.com"});h.interceptors.request.use(e=>{const r=A();return e.headers.Authorization="Bearer "+r.token,e});h.interceptors.response.use(e=>e,e=>{if(e.response&&e.response.data.message==="JWT 過期"&&e.config.url!=="/users/extend"){const r=A();return h.patch("/users/extend").then(({data:o})=>(r.token=o.result,e.config.headers.Authorization="Bearer "+r.token,E(e.config))).catch(()=>(r.logout(),Promise.reject(e)))}return Promise.reject(e)});const G=()=>({api:M,apiAuth:h}),A=F("user",()=>{const{apiAuth:e}=G(),r=_(""),o=_(""),a=_(""),t=_(""),s=_([]),n=_(0),i=_(v.USER),m=u=>{u.token&&(r.value=u.token),o.value=u.account,a.value=u.account,t.value=u.email,i.value=u.role,s.value=u.favorite,n.value=u.cart},c=L(()=>r.value.length>0),d=L(()=>i.value===v.ADMIN),f=()=>g(null,null,function*(){if(r.value.length!==0)try{const{data:u}=yield e.get("/users/me");m(u.result)}catch(u){p()}}),p=()=>{r.value="",o.value="",a.value="",t.value="",i.value=v.USER,n.value=0};return{token:r,account:o,email:t,cart:n,role:i,login:m,logout:p,isLogin:c,isAdmin:d,getProfile:f,favorite:s,nickname:a}},{persist:{key:"20240131",paths:["token"]}}),J=[{path:"/",component:()=>l(()=>import("./FrontLayout-DSSIPlJS.js"),__vite__mapDeps([0,1,2,3,4])),children:[{path:"",name:"Home",component:()=>l(()=>import("./HomeView-BcfP3cDl.js"),__vite__mapDeps([5,1,2,3,6,4])),meta:{title:"書評網",login:!1,admin:!1}},{path:"register",name:"Register",component:()=>l(()=>import("./RegisterView-1aTmBjFY.js"),__vite__mapDeps([7,1,2,3,4])),meta:{title:"書評網 | 註冊",login:!1,admin:!1}},{path:"login",name:"Login",component:()=>l(()=>import("./LoginView-rIPiDv6-.js"),__vite__mapDeps([8,1,2,3,4])),meta:{title:"書評網 | 登入",login:!1,admin:!1}},{path:"books/:id",name:"Book",component:()=>l(()=>import("./BookView-OhGwN6TI.js"),__vite__mapDeps([9,1,2,3,4])),meta:{title:"書評網 | 書籍",login:!1,admin:!1}},{path:"mybook",name:"Mybook",component:()=>l(()=>import("./MybookView-CCmkmaP2.js"),__vite__mapDeps([10,1,2,3,4])),meta:{title:"書評網 | 我的最愛書籍",login:!0,admin:!1}},{path:"cart",name:"Cart",component:()=>l(()=>import("./CartView-DsV7s1gd.js"),__vite__mapDeps([11,1,2,3,4])),meta:{title:"書評網 | 購物車",login:!1,admin:!1}},{path:"orders",name:"Orders",component:()=>l(()=>import("./OrdersView-Cu_4P00B.js"),__vite__mapDeps([12,1,2,3,4])),meta:{title:"購物網 | 訂單",login:!0,admin:!1}}]},{path:"/admin",component:()=>l(()=>import("./AdminLayout-2n7cqc3g.js"),__vite__mapDeps([13,1,2,3,4])),children:[{path:"",name:"AdminHome",component:()=>l(()=>import("./HomeView-D2VODeFg.js"),__vite__mapDeps([14,1,2,3,4])),meta:{title:"購物網 | 管理",login:!0,admin:!0}},{path:"bookmanagement",name:"AdminBookmanagement",component:()=>l(()=>import("./BookmanagementView-BXqBRqRm.js"),__vite__mapDeps([15,1,2,3,16,4])),meta:{title:"購物網 | 書本管理",login:!0,admin:!0}},{path:"orders",name:"AdminOrders",component:()=>l(()=>import("./OrdersView-PcA0w40T.js"),__vite__mapDeps([17,1,2,3,4])),meta:{title:"購物網 | 訂單管理",login:!0,admin:!0}},{path:"import",name:"Import",component:()=>l(()=>import("./ImportView-IXBhG5GJ.js"),__vite__mapDeps([18,1,2,3,4])),meta:{title:"書評網 | 引入書籍",login:!1,admin:!1}}]}],y=D({history:V("/book-front/"),routes:J});y.afterEach((e,r)=>{document.title=e.meta.title});y.beforeEach((e,r,o)=>g(null,null,function*(){const a=A();r===S&&(yield a.getProfile()),a.isLogin&&["/register","/login"].includes(e.path)?o("/"):e.meta.login&&!a.isLogin?o("/login"):e.meta.admin&&!a.isAdmin?o("/"):o()}));function K(e){e.use(R).use(w).use(b).use(y)}const Z=(e,r)=>{const o=e.__vccOpts||e;for(const[a,t]of r)o[a]=t;return o},Q={};function X(e,r){const o=C("router-view");return U(),B(z,null,{default:H(()=>[N(o)]),_:1})}const Y=Z(Q,[["render",X]]);setTimeout(()=>{l(()=>Promise.resolve({}),__vite__mapDeps([4]))},100);const P=j(Y);K(P);P.mount("#app");P.use(R);export{Z as _,G as a,A as u};
