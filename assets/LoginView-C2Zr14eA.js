import{J as x,R as _,D as h,G as o,a0 as S,F as k,H as a,a8 as B,a9 as i,a5 as y,ag as C,ah as F,ai as M,u as s,ad as d,a1 as N,Y as R}from"./vue-vendor-DZ6ShR-l.js";import{b as U,e as c,u as q,h as m}from"./vendor-fvIX-KvJ.js";import{u as D,a as P}from"./index-Mk3cYYfI.js";const H={__name:"LoginView",setup(T){const{api:p}=P(),g=_(),u=x(),V=D(),b=U({account:c().required("帳號為必填欄位").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),password:c().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符")}),{handleSubmit:f,isSubmitting:w}=q({validationSchema:b}),r=m("account"),l=m("password"),v=f(async n=>{try{const{data:e}=await p.post("/users/login",{account:n.account,password:n.password});V.login(e.result),u({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),g.push("/")}catch(e){console.log(e);const t=e?.response?.data?.message||"發生錯誤，請稍後再試";u({text:t,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(n,e)=>(k(),h(S,null,{default:o(()=>[a(B,{class:"text-center"},{default:o(()=>[a(i,{cols:"12"},{default:o(()=>e[2]||(e[2]=[y("h1",null,"登入",-1)])),_:1,__:[2]}),a(C),a(i,{cols:"12"},{default:o(()=>[a(F,{disabled:s(w),onSubmit:M(s(v),["prevent"])},{default:o(()=>[a(d,{label:"帳號",minlength:"4",maxlength:"20",counter:"",modelValue:s(r).value.value,"onUpdate:modelValue":e[0]||(e[0]=t=>s(r).value.value=t),"error-messages":s(r).errorMessage.value,"prepend-icon":"mdi-account"},null,8,["modelValue","error-messages"]),a(d,{label:"密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:s(l).value.value,"onUpdate:modelValue":e[1]||(e[1]=t=>s(l).value.value=t),"error-messages":s(l).errorMessage.value,"prepend-icon":"mdi-key"},null,8,["modelValue","error-messages"]),a(N,{type:"submit",color:"#4d4637"},{default:o(()=>e[3]||(e[3]=[R("登入",-1)])),_:1,__:[3]})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{H as default};
