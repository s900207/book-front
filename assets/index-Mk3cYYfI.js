const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FrontLayout-Dw_AYDMH.js","assets/vue-vendor-DZ6ShR-l.js","assets/vue-vendor-BxSFW_Ei.css","assets/vendor-fvIX-KvJ.js","assets/vendor-Q6EcL2nC.css","assets/HomeView-Bgz5MOng.js","assets/HomeView-zYBd93x1.css","assets/RegisterView-DGpNtpoF.js","assets/LoginView-C2Zr14eA.js","assets/BookView-Czy2axDI.js","assets/MybookView-Do6DCexN.js","assets/CartView-CZF1Nfr3.js","assets/OrdersView-CVA5N7ic.js","assets/AdminLayout-BXAPetJv.js","assets/HomeView-BJ9Ylkw0.js","assets/BookmanagementView-C8f7w3pN.js","assets/BookmanagementView-Dd_KhQgX.css","assets/OrdersView-DwnpdBTn.js","assets/ImportView-CCr5MV0C.js"])))=>i.map(i=>d[i]);
import{y as k,z as I,r as f,d as P,A as T,B as D,S as V,C as S,D as w,E as N,F as B,G as C,H as U,V as H,I as M}from"./vue-vendor-DZ6ShR-l.js";import{c as z,s as j,a as v,d as q}from"./vendor-fvIX-KvJ.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(t){if(t.ep)return;t.ep=!0;const r=n(t);fetch(t.href,r)}})();const O=k({theme:{themes:{light:{colors:{primary:"#1867C0",secondary:"#5CBBF6"}}}},locale:{locale:"zhHant",messages:{zhHant:I}},icons:{defaultSet:"mdi"}}),R=z();R.use(j);const x="modulepreload",F=function(e){return"/book-front/"+e},L={},l=function(o,n,i){let t=Promise.resolve();if(n&&n.length>0){let _=function(u){return Promise.all(u.map(p=>Promise.resolve(p).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=s?.nonce||s?.getAttribute("nonce");t=_(n.map(u=>{if(u=F(u),u in L)return;L[u]=!0;const p=u.endsWith(".css"),d=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":x,p||(m.as="script"),m.crossOrigin="",m.href=u,a&&m.setAttribute("nonce",a),document.head.appendChild(m),p)return new Promise((c,b)=>{m.addEventListener("load",c),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return t.then(s=>{for(const a of s||[])a.status==="rejected"&&r(a.reason);return o().catch(r)})},g={USER:0,ADMIN:1},W=v.create({baseURL:"https://book-back-b23l.onrender.com"}),h=v.create({baseURL:"https://book-back-b23l.onrender.com"});h.interceptors.request.use(e=>{const o=E();return e.headers.Authorization="Bearer "+o.token,e});h.interceptors.response.use(e=>e,e=>{if(e.response&&e.response.data.message==="JWT 過期"&&e.config.url!=="/users/extend"){const o=E();return h.patch("/users/extend").then(({data:n})=>(o.token=n.result,e.config.headers.Authorization="Bearer "+o.token,v(e.config))).catch(()=>(o.logout(),Promise.reject(e)))}return Promise.reject(e)});const $=()=>({api:W,apiAuth:h}),E=q("user",()=>{const{apiAuth:e}=$(),o=f(""),n=f(""),i=f(""),t=f(""),r=f([]),s=f(0),a=f(g.USER),_=c=>{c.token&&(o.value=c.token),n.value=c.account,i.value=c.account,t.value=c.email,a.value=c.role,r.value=c.favorite,s.value=c.cart},u=P(()=>o.value.length>0),p=P(()=>a.value===g.ADMIN),d=async()=>{if(o.value.length!==0)try{const{data:c}=await e.get("/users/me");_(c.result)}catch{m()}},m=()=>{o.value="",n.value="",i.value="",t.value="",a.value=g.USER,s.value=0};return{token:o,account:n,email:t,cart:s,role:a,login:_,logout:m,isLogin:u,isAdmin:p,getProfile:d,favorite:r,nickname:i}},{persist:{key:"20240131",paths:["token"]}}),G=[{path:"/",component:()=>l(()=>import("./FrontLayout-Dw_AYDMH.js"),__vite__mapDeps([0,1,2,3,4])),children:[{path:"",name:"Home",component:()=>l(()=>import("./HomeView-Bgz5MOng.js"),__vite__mapDeps([5,1,2,3,4,6])),meta:{title:"書評網",login:!1,admin:!1}},{path:"register",name:"Register",component:()=>l(()=>import("./RegisterView-DGpNtpoF.js"),__vite__mapDeps([7,1,2,3,4])),meta:{title:"書評網 | 註冊",login:!1,admin:!1}},{path:"login",name:"Login",component:()=>l(()=>import("./LoginView-C2Zr14eA.js"),__vite__mapDeps([8,1,2,3,4])),meta:{title:"書評網 | 登入",login:!1,admin:!1}},{path:"books/:id",name:"Book",component:()=>l(()=>import("./BookView-Czy2axDI.js"),__vite__mapDeps([9,1,2,3,4])),meta:{title:"書評網 | 書籍",login:!1,admin:!1}},{path:"mybook",name:"Mybook",component:()=>l(()=>import("./MybookView-Do6DCexN.js"),__vite__mapDeps([10,1,2,3,4])),meta:{title:"書評網 | 我的最愛書籍",login:!0,admin:!1}},{path:"cart",name:"Cart",component:()=>l(()=>import("./CartView-CZF1Nfr3.js"),__vite__mapDeps([11,1,2,3,4])),meta:{title:"書評網 | 購物車",login:!1,admin:!1}},{path:"orders",name:"Orders",component:()=>l(()=>import("./OrdersView-CVA5N7ic.js"),__vite__mapDeps([12,1,2,3,4])),meta:{title:"購物網 | 訂單",login:!0,admin:!1}}]},{path:"/admin",component:()=>l(()=>import("./AdminLayout-BXAPetJv.js"),__vite__mapDeps([13,1,2,3,4])),children:[{path:"",name:"AdminHome",component:()=>l(()=>import("./HomeView-BJ9Ylkw0.js"),__vite__mapDeps([14,1,2,3,4])),meta:{title:"購物網 | 管理",login:!0,admin:!0}},{path:"bookmanagement",name:"AdminBookmanagement",component:()=>l(()=>import("./BookmanagementView-C8f7w3pN.js"),__vite__mapDeps([15,1,2,3,4,16])),meta:{title:"購物網 | 書本管理",login:!0,admin:!0}},{path:"orders",name:"AdminOrders",component:()=>l(()=>import("./OrdersView-DwnpdBTn.js"),__vite__mapDeps([17,1,2,3,4])),meta:{title:"購物網 | 訂單管理",login:!0,admin:!0}},{path:"import",name:"Import",component:()=>l(()=>import("./ImportView-CCr5MV0C.js"),__vite__mapDeps([18,1,2,3,4])),meta:{title:"書評網 | 引入書籍",login:!1,admin:!1}}]}],A=T({history:D("/book-front/"),routes:G});A.afterEach((e,o)=>{document.title=e.meta.title});A.beforeEach(async(e,o,n)=>{const i=E();o===V&&await i.getProfile(),i.isLogin&&["/register","/login"].includes(e.path)?n("/"):e.meta.login&&!i.isLogin?n("/login"):e.meta.admin&&!i.isAdmin?n("/"):n()});function J(e){e.use(O).use(S).use(R).use(A)}const K=(e,o)=>{const n=e.__vccOpts||e;for(const[i,t]of o)n[i]=t;return n},Z={};function Q(e,o){const n=N("router-view");return B(),w(H,null,{default:C(()=>[U(n)]),_:1})}const X=K(Z,[["render",Q]]),y=M(X);J(y);y.mount("#app");y.use(O);export{K as _,$ as a,E as u};
