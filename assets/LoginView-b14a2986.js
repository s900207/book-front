import{U as S,W as k,Z as B,$ as a,af as y,a2 as C,a4 as F,c as e,a6 as o,ax as U,au as i,a7 as m,a9 as M,a8 as N,ae as $}from"./index-3347f3b5.js";import{u as q,a as d}from"./vee-validate.esm-c424f1cb.js";import{c as P,a as p}from"./index.esm-3d8b24aa.js";import{V as R}from"./VContainer-c328e665.js";import{V as f}from"./VCol-0b475635.js";import{V as T}from"./VDivider-879d99ae.js";import{V as A}from"./VForm-34bf0b1f.js";import{V as D}from"./VRow-f42937c7.js";const I=$("h1",null,"登入",-1),K={__name:"LoginView",setup(L){const{api:V}=y(),g=C(),c=S(),b=k(),h=P({account:p().required("帳號為必填欄位").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),password:p().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符")}),{handleSubmit:_,isSubmitting:v}=q({validationSchema:h}),n=d("account"),l=d("password"),w=_(async u=>{var s,t;try{const{data:r}=await V.post("/users/login",{account:u.account,password:u.password});b.login(r.result),c({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),g.push("/")}catch(r){console.log(r);const x=((t=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:t.message)||"發生錯誤，請稍後再試";c({text:x,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(u,s)=>(F(),B(R,null,{default:a(()=>[e(D,{class:"text-center"},{default:a(()=>[e(f,{cols:"12"},{default:a(()=>[I]),_:1}),e(T),e(f,{cols:"12"},{default:a(()=>[e(A,{disabled:o(v),onSubmit:U(o(w),["prevent"])},{default:a(()=>[e(i,{label:"帳號",minlength:"4",maxlength:"20",counter:"",modelValue:o(n).value.value,"onUpdate:modelValue":s[0]||(s[0]=t=>o(n).value.value=t),"error-messages":o(n).errorMessage.value},{"prepend-inner":a(()=>[e(m,{href:"#icon-account"})]),_:1},8,["modelValue","error-messages"]),e(i,{label:"密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:o(l).value.value,"onUpdate:modelValue":s[1]||(s[1]=t=>o(l).value.value=t),"error-messages":o(l).errorMessage.value},{"prepend-inner":a(()=>[e(m,{href:"#icon-key"})]),_:1},8,["modelValue","error-messages"]),e(M,{type:"submit",color:"#4d4637"},{default:a(()=>[N("登入")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{K as default};
