const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FrontLayout-DyWZg4pB.js","assets/vue-vendor-CO2Qqhmb.js","assets/vue-vendor-BAFL1yxD.css","assets/vendor-oObasS19.js","assets/mdi-vendor-aPHlSQtF.css","assets/HomeView-Dj4Hz-nx.js","assets/HomeView-zYBd93x1.css","assets/RegisterView-DyCMJttP.js","assets/LoginView-BXxw8y7G.js","assets/BookView-EqNxmTG6.js","assets/MybookView-uhKNJJAt.js","assets/CartView-D1PiZbeO.js","assets/OrdersView-C3r5aIiP.js","assets/AdminLayout-DZ_dsRC8.js","assets/HomeView-B-XA4y-L.js","assets/BookmanagementView-S2_68mLM.js","assets/BookmanagementView-Dd_KhQgX.css","assets/OrdersView-YIT3Q7_t.js","assets/ImportView-BTxFUBeo.js"])))=>i.map(i=>d[i]);
var g=(e,r,o)=>new Promise((a,t)=>{var s=m=>{try{i(o.next(m))}catch(c){t(c)}},n=m=>{try{i(o.throw(m))}catch(c){t(c)}},i=m=>m.done?a(m.value):Promise.resolve(m.value).then(s,n);i((o=o.apply(e,r)).next())});import{y as k,z as I,r as _,d as P,A as T,B as D,S as V,C as S,D as w,E as B,F as C,G as U,H,V as N,I as z}from"./vue-vendor-CO2Qqhmb.js";import{c as j,s as q,a as E,d as x}from"./vendor-oObasS19.js";/* empty css                   */(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();const F=k({theme:{themes:{light:{colors:{primary:"#1867C0",secondary:"#5CBBF6"}}}},locale:{locale:"zhHant",messages:{zhHant:I}},icons:{defaultSet:"mdi"}}),O=j();O.use(q);const W="modulepreload",$=function(e){return"/book-front/"+e},L={},u=function(r,o,a){let t=Promise.resolve();if(o&&o.length>0){let m=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),i=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));t=m(o.map(c=>{if(c=$(c),c in L)return;L[c]=!0;const d=c.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":W,d||(p.as="script"),p.crossOrigin="",p.href=c,i&&p.setAttribute("nonce",i),document.head.appendChild(p),d)return new Promise((l,b)=>{p.addEventListener("load",l),p.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(n){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n}return t.then(n=>{for(const i of n||[])i.status==="rejected"&&s(i.reason);return r().catch(s)})},v={USER:0,ADMIN:1},M=E.create({baseURL:"https://book-back-b23l.onrender.com"}),h=E.create({baseURL:"https://book-back-b23l.onrender.com"});h.interceptors.request.use(e=>{const r=A();return e.headers.Authorization="Bearer "+r.token,e});h.interceptors.response.use(e=>e,e=>{if(e.response&&e.response.data.message==="JWT 過期"&&e.config.url!=="/users/extend"){const r=A();return h.patch("/users/extend").then(({data:o})=>(r.token=o.result,e.config.headers.Authorization="Bearer "+r.token,E(e.config))).catch(()=>(r.logout(),Promise.reject(e)))}return Promise.reject(e)});const G=()=>({api:M,apiAuth:h}),A=x("user",()=>{const{apiAuth:e}=G(),r=_(""),o=_(""),a=_(""),t=_(""),s=_([]),n=_(0),i=_(v.USER),m=l=>{l.token&&(r.value=l.token),o.value=l.account,a.value=l.account,t.value=l.email,i.value=l.role,s.value=l.favorite,n.value=l.cart},c=P(()=>r.value.length>0),d=P(()=>i.value===v.ADMIN),f=()=>g(null,null,function*(){if(r.value.length!==0)try{const{data:l}=yield e.get("/users/me");m(l.result)}catch(l){p()}}),p=()=>{r.value="",o.value="",a.value="",t.value="",i.value=v.USER,n.value=0};return{token:r,account:o,email:t,cart:n,role:i,login:m,logout:p,isLogin:c,isAdmin:d,getProfile:f,favorite:s,nickname:a}},{persist:{key:"20240131",paths:["token"]}}),J=[{path:"/",component:()=>u(()=>import("./FrontLayout-DyWZg4pB.js"),__vite__mapDeps([0,1,2,3,4])),children:[{path:"",name:"Home",component:()=>u(()=>import("./HomeView-Dj4Hz-nx.js"),__vite__mapDeps([5,1,2,3,6,4])),meta:{title:"書評網",login:!1,admin:!1}},{path:"register",name:"Register",component:()=>u(()=>import("./RegisterView-DyCMJttP.js"),__vite__mapDeps([7,1,2,3,4])),meta:{title:"書評網 | 註冊",login:!1,admin:!1}},{path:"login",name:"Login",component:()=>u(()=>import("./LoginView-BXxw8y7G.js"),__vite__mapDeps([8,1,2,3,4])),meta:{title:"書評網 | 登入",login:!1,admin:!1}},{path:"books/:id",name:"Book",component:()=>u(()=>import("./BookView-EqNxmTG6.js"),__vite__mapDeps([9,1,2,3,4])),meta:{title:"書評網 | 書籍",login:!1,admin:!1}},{path:"mybook",name:"Mybook",component:()=>u(()=>import("./MybookView-uhKNJJAt.js"),__vite__mapDeps([10,1,2,3,4])),meta:{title:"書評網 | 我的最愛書籍",login:!0,admin:!1}},{path:"cart",name:"Cart",component:()=>u(()=>import("./CartView-D1PiZbeO.js"),__vite__mapDeps([11,1,2,3,4])),meta:{title:"書評網 | 購物車",login:!1,admin:!1}},{path:"orders",name:"Orders",component:()=>u(()=>import("./OrdersView-C3r5aIiP.js"),__vite__mapDeps([12,1,2,3,4])),meta:{title:"購物網 | 訂單",login:!0,admin:!1}}]},{path:"/admin",component:()=>u(()=>import("./AdminLayout-DZ_dsRC8.js"),__vite__mapDeps([13,1,2,3,4])),children:[{path:"",name:"AdminHome",component:()=>u(()=>import("./HomeView-B-XA4y-L.js"),__vite__mapDeps([14,1,2,3,4])),meta:{title:"購物網 | 管理",login:!0,admin:!0}},{path:"bookmanagement",name:"AdminBookmanagement",component:()=>u(()=>import("./BookmanagementView-S2_68mLM.js"),__vite__mapDeps([15,1,2,3,16,4])),meta:{title:"購物網 | 書本管理",login:!0,admin:!0}},{path:"orders",name:"AdminOrders",component:()=>u(()=>import("./OrdersView-YIT3Q7_t.js"),__vite__mapDeps([17,1,2,3,4])),meta:{title:"購物網 | 訂單管理",login:!0,admin:!0}},{path:"import",name:"Import",component:()=>u(()=>import("./ImportView-BTxFUBeo.js"),__vite__mapDeps([18,1,2,3,4])),meta:{title:"書評網 | 引入書籍",login:!1,admin:!1}}]}],y=T({history:D("/book-front/"),routes:J});y.afterEach((e,r)=>{document.title=e.meta.title});y.beforeEach((e,r,o)=>g(null,null,function*(){const a=A();r===V&&(yield a.getProfile()),a.isLogin&&["/register","/login"].includes(e.path)?o("/"):e.meta.login&&!a.isLogin?o("/login"):e.meta.admin&&!a.isAdmin?o("/"):o()}));function K(e){e.use(F).use(S).use(O).use(y)}const Z=(e,r)=>{const o=e.__vccOpts||e;for(const[a,t]of r)o[a]=t;return o},Q={};function X(e,r){const o=B("router-view");return C(),w(N,null,{default:U(()=>[H(o)]),_:1})}const Y=Z(Q,[["render",X]]),R=z(Y);K(R);R.mount("#app");export{Z as _,G as a,A as u};
