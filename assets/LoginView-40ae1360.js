var f=(V,m,r)=>new Promise((i,d)=>{var p=e=>{try{c(r.next(e))}catch(o){d(o)}},b=e=>{try{c(r.throw(e))}catch(o){d(o)}},c=e=>e.done?i(e.value):Promise.resolve(e.value).then(p,b);c((r=r.apply(V,m)).next())});import{O as k,G as B,H as u,a2 as y,X as C,F,I as a,ac as h,am as M,an as N,u as s,ao as U,ai as w,a3 as q,a0 as P,ab as R,M as T}from"./vue-vendor-5ccff89c.js";import{b as $,e as v,u as A,h as x}from"./vendor-1de8772a.js";import{u as D,a as G}from"./index-79ded718.js";const H=T("h1",null,"登入",-1),j={__name:"LoginView",setup(V){const{api:m}=G(),r=C(),i=k(),d=D(),p=$({account:v().required("帳號為必填欄位").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),password:v().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符")}),{handleSubmit:b,isSubmitting:c}=A({validationSchema:p}),e=x("account"),o=x("password"),_=b(g=>f(this,null,function*(){var t,l;try{const{data:n}=yield m.post("/users/login",{account:g.account,password:g.password});d.login(n.result),i({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),r.push("/")}catch(n){console.log(n);const S=((l=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";i({text:S,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}));return(g,t)=>(F(),B(y,null,{default:u(()=>[a(R,{class:"text-center"},{default:u(()=>[a(h,{cols:"12"},{default:u(()=>[H]),_:1}),a(M),a(h,{cols:"12"},{default:u(()=>[a(N,{disabled:s(c),onSubmit:U(s(_),["prevent"])},{default:u(()=>[a(w,{label:"帳號",minlength:"4",maxlength:"20",counter:"",modelValue:s(e).value.value,"onUpdate:modelValue":t[0]||(t[0]=l=>s(e).value.value=l),"error-messages":s(e).errorMessage.value,"prepend-icon":"mdi-account"},null,8,["modelValue","error-messages"]),a(w,{label:"密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:s(o).value.value,"onUpdate:modelValue":t[1]||(t[1]=l=>s(o).value.value=l),"error-messages":s(o).errorMessage.value,"prepend-icon":"mdi-key"},null,8,["modelValue","error-messages"]),a(q,{type:"submit",color:"#4d4637"},{default:u(()=>[P("登入")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{j as default};
