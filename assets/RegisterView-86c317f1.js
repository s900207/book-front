var h=(x,V,n)=>new Promise((i,d)=>{var f=a=>{try{r(n.next(a))}catch(t){d(t)}},b=a=>{try{r(n.throw(a))}catch(t){d(t)}},r=a=>a.done?i(a.value):Promise.resolve(a.value).then(f,b);r((n=n.apply(x,V)).next())});import{O as k,G as B,H as m,a2 as M,X as S,F,I as l,ac as y,am as q,an as U,u as e,ao as N,ai as p,a3 as R,a0 as $,ab as E,M as O}from"./vue-vendor-5ccff89c.js";import{b as P,e as g,v as T,f as A,u as D,h as v}from"./vendor-1de8772a.js";import{a as G}from"./index-79ded718.js";const H=O("h1",null,"註冊",-1),J={__name:"RegisterView",setup(x){const{api:V}=G(),n=S(),i=k(),d=P({account:g().required("帳號為必填欄位").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),email:g().required("信箱為必填欄位").test("isEmail","信箱格式錯誤",u=>T.isEmail(u)),password:g().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符"),passwordConfirm:g().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符").oneOf([A("password")],"密碼不一致")}),{handleSubmit:f,isSubmitting:b}=D({validationSchema:d}),r=v("account"),a=v("email"),t=v("password"),w=v("passwordConfirm"),C=f(u=>h(this,null,function*(){var s,o;try{yield V.post("/users",{account:u.account,email:u.email,password:u.password}),i({text:"註冊成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),n.push("/login")}catch(c){console.log(c);const _=((o=(s=c==null?void 0:c.response)==null?void 0:s.data)==null?void 0:o.message)||"發生錯誤，請稍後再試";i({text:_,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}));return(u,s)=>(F(),B(M,null,{default:m(()=>[l(E,{class:"text-center"},{default:m(()=>[l(y,{cols:"12"},{default:m(()=>[H]),_:1}),l(q),l(y,{cols:"12"},{default:m(()=>[l(U,{disabled:e(b),onSubmit:N(e(C),["prevent"])},{default:m(()=>[l(p,{label:"帳號",minlength:"4",maxlength:"20",counter:"",modelValue:e(r).value.value,"onUpdate:modelValue":s[0]||(s[0]=o=>e(r).value.value=o),"error-messages":e(r).errorMessage.value,"prepend-icon":"mdi-account"},null,8,["modelValue","error-messages"]),l(p,{label:"信箱",type:"email",modelValue:e(a).value.value,"onUpdate:modelValue":s[1]||(s[1]=o=>e(a).value.value=o),"error-messages":e(a).errorMessage.value,"prepend-icon":"mdi-email"},null,8,["modelValue","error-messages"]),l(p,{label:"密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:e(t).value.value,"onUpdate:modelValue":s[2]||(s[2]=o=>e(t).value.value=o),"error-messages":e(t).errorMessage.value,"prepend-icon":"mdi-key"},null,8,["modelValue","error-messages"]),l(p,{label:"確認密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:e(w).value.value,"onUpdate:modelValue":s[3]||(s[3]=o=>e(w).value.value=o),"error-messages":e(w).errorMessage.value,"prepend-icon":"mdi-key-change"},null,8,["modelValue","error-messages"]),l(R,{type:"submit",color:"#4d4637"},{default:m(()=>[$("註冊")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{J as default};
