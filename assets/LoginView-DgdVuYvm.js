var f=(b,c,r)=>new Promise((d,m)=>{var p=e=>{try{i(r.next(e))}catch(t){m(t)}},g=e=>{try{i(r.throw(e))}catch(t){m(t)}},i=e=>e.done?d(e.value):Promise.resolve(e.value).then(p,g);i((r=r.apply(b,c)).next())});import{J as k,R as B,D as y,G as u,a0 as C,F,H as s,a8 as M,a9 as w,a5 as N,ag as R,ah as U,ai as q,u as o,ad as v,a1 as D,Y as P}from"./vue-vendor-CO2Qqhmb.js";import{b as T,e as x,u as $,h as _}from"./vendor-oObasS19.js";import{u as A,a as G}from"./index-BzE3j7FH.js";/* empty css                   */const z={__name:"LoginView",setup(b){const{api:c}=G(),r=B(),d=k(),m=A(),p=T({account:x().required("帳號為必填欄位").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),password:x().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符")}),{handleSubmit:g,isSubmitting:i}=$({validationSchema:p}),e=_("account"),t=_("password"),h=g(V=>f(null,null,function*(){var a,l;try{const{data:n}=yield c.post("/users/login",{account:V.account,password:V.password});m.login(n.result),d({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),r.push("/")}catch(n){console.log(n);const S=((l=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";d({text:S,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}));return(V,a)=>(F(),y(C,null,{default:u(()=>[s(M,{class:"text-center"},{default:u(()=>[s(w,{cols:"12"},{default:u(()=>a[2]||(a[2]=[N("h1",null,"登入",-1)])),_:1,__:[2]}),s(R),s(w,{cols:"12"},{default:u(()=>[s(U,{disabled:o(i),onSubmit:q(o(h),["prevent"])},{default:u(()=>[s(v,{label:"帳號",minlength:"4",maxlength:"20",counter:"",modelValue:o(e).value.value,"onUpdate:modelValue":a[0]||(a[0]=l=>o(e).value.value=l),"error-messages":o(e).errorMessage.value,"prepend-icon":"mdi-account"},null,8,["modelValue","error-messages"]),s(v,{label:"密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:o(t).value.value,"onUpdate:modelValue":a[1]||(a[1]=l=>o(t).value.value=l),"error-messages":o(t).errorMessage.value,"prepend-icon":"mdi-key"},null,8,["modelValue","error-messages"]),s(D,{type:"submit",color:"#4d4637"},{default:u(()=>a[3]||(a[3]=[P("登入",-1)])),_:1,__:[3]})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{z as default};
